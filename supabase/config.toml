project_id = "dmkxtkvlispxeqfzlczr"

# ============================================
# MODERNIZED V2 FUNCTIONS (New - Active)
# ============================================

[functions.create-checkout-session]
verify_jwt = true

[functions.stripe-webhook-v2]
verify_jwt = false

[functions.process-order-v2]
verify_jwt = false

[functions.scheduled-order-processor]
verify_jwt = false

[functions.auto-gift-orchestrator]
verify_jwt = false

[functions.approve-auto-gift]
verify_jwt = false

[functions.order-monitor-v2]
verify_jwt = false

[functions.webhook-signature-validator]
verify_jwt = false

[functions.admin-order-tools]
verify_jwt = true

[functions.reconcile-checkout-session]
verify_jwt = false

[functions.zinc-webhook]
verify_jwt = false

[functions.cancel-zinc-order]
verify_jwt = true

[functions.process-stripe-refund]
verify_jwt = true

[functions.get-stripe-balance]
verify_jwt = true

# ============================================
# ZMA FUNDING MANAGEMENT
# ============================================

[functions.manage-zma-accounts]
verify_jwt = true

[functions.retry-awaiting-funds-orders]
verify_jwt = true

[functions.zma-balance-monitor]
verify_jwt = false

# ============================================
# ESSENTIAL UTILITY FUNCTIONS
# ============================================

[functions.get-products]
verify_jwt = false

[functions.get-product-detail]
verify_jwt = false

[functions.search-suggestions]
verify_jwt = false

[functions.get-shipping-quote]
verify_jwt = false

[functions.save-payment-method]
verify_jwt = true

[functions.get-payment-method-details]
verify_jwt = true

[functions.nicole-unified-agent]
verify_jwt = false

[functions.process-email-queue]
verify_jwt = false

[functions.setup-email-templates]
verify_jwt = false

[functions.ecommerce-email-orchestrator]
verify_jwt = false

[functions.detect-abandoned-carts]
verify_jwt = false

[functions.cleanup-auth-rate-limits]
verify_jwt = false

[functions.session-validator]
verify_jwt = false

[functions.authenticate-reset-token]
verify_jwt = false

[functions.send-invitation-reminders]
verify_jwt = false

[functions.validate-invite]
verify_jwt = false

[functions.collect-recipient-address]
verify_jwt = false

[functions.generate-gift-preview-token]
verify_jwt = false

[functions.validate-payment-methods]
verify_jwt = false

[functions.seed-product-catalog]
verify_jwt = false

[functions.nicole-weekly-curator]
verify_jwt = false

[functions.nicole-recommendations]
verify_jwt = false

[functions.delete-user-account]
verify_jwt = true

[functions.claim-guest-orders]
verify_jwt = false

# ============================================
# CRON JOBS - V2 MODERNIZED SYSTEM
# ============================================

# V2: Scheduled order processor - captures held payments, processes deliveries (daily 2 AM)
[[crons.scheduled_order_processor]]
function_name = "scheduled-order-processor"
schedule = "0 2 * * *"

# V2: Auto-gift orchestrator - manages auto-gifting workflows (daily 3 AM)
[[crons.auto_gift_orchestrator]]
function_name = "auto-gift-orchestrator"
schedule = "0 3 * * *"

# V2: Order monitor - checks Zinc status, detects stuck orders (every 15 min)
[[crons.order_monitor]]
function_name = "order-monitor-v2"
schedule = "*/15 * * * *"

# ZMA Balance Monitor - checks balance and sends alerts (daily 9 AM)
[[crons.zma_balance_monitor]]
function_name = "zma-balance-monitor"
schedule = "0 9 * * *"

# Email queue processor (every minute)
[[crons.process_email_queue]]
function_name = "process-email-queue"
schedule = "* * * * *"

# Abandoned cart detection (every 15 minutes)
[[crons.detect_abandoned_carts]]
function_name = "detect-abandoned-carts"
schedule = "*/15 * * * *"

# Auth rate limits cleanup (daily 3 AM)
[[crons.cleanup_auth_rate_limits]]
function_name = "cleanup-auth-rate-limits"
schedule = "0 3 * * *"

# Invitation reminders (daily 10 AM)
[[crons.send_invitation_reminders]]
function_name = "send-invitation-reminders"
schedule = "0 10 * * *"

# Payment method validation - before auto-gift processing (daily 8 AM)
[[crons.validate_payment_methods]]
function_name = "validate-payment-methods"
schedule = "0 8 * * *"

# Nicole Weekly Curator - refresh trending products (Sundays 3 AM)
[[crons.nicole_weekly_curator]]
function_name = "nicole-weekly-curator"
schedule = "0 3 * * 0"
